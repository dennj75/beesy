<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <title>Aggiornamento Sicurezza - â‚¿eesy</title>
    <link rel="icon" href="/static/img/favicon.ico" type="image/png" />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}?v=2"
    />
  </head>
  <body>
    {% include "partials/logo.html" %}
    <div class="logo-container">
      <a href="/">
        <img
          src="{{ url_for('static', filename='img/beesy_dark_1.png') }}"
          alt="Logo Sito"
          class="site-logo"
        />
      </a>
    </div>

    <h1>Aggiornamento di Sicurezza Obbligatorio</h1>

    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %}
    <ul class="flashes">
      {% for category, message in messages %}
      <li class="{{ category }}">{{ message }}</li>
      {% endfor %}
    </ul>
    {% endif %} {% endwith %}

    <p>
      Ciao <strong>{{ username }}</strong>, abbiamo rafforzato i requisiti di
      sicurezza. Per continuare, devi impostare subito una nuova password:
    </p>

    <div style="border: 1px solid #ccc; padding: 15px; margin-bottom: 20px">
      <p><strong>Requisiti Minimi:</strong></p>
      <ul>
        <li>Almeno 12 caratteri (spazi ammessi, ad esempio per una frase)</li>
        <li>Almeno una lettera maiuscola</li>
        <li>Almeno un numero</li>
        <li>Almeno un carattere speciale (!, @, #, $, ecc.)</li>
      </ul>
    </div>

    <form method="post">
      <label
        >Nuova Password: <input name="new_password" type="password" required
      /></label>
      <label
        >Conferma Nuova Password:
        <input name="confirm_password" type="password" required
      /></label>
      <button type="submit">Aggiorna Password e Continua</button>
    </form>

    <p><a href="{{ url_for('auth.logout') }}">Torna al Login</a></p>
  </body>
</html>
